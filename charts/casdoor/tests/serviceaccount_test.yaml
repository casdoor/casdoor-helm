suite: test serviceaccount
templates:
- serviceaccount.yaml

tests:
- it: should not render when disabled
  set:
    serviceAccount.create: false
  asserts:
  - hasDocuments:
      count: 0

- it: should render with default values
  set:
    serviceAccount.create: true
  asserts:
  - matchSnapshot: {}

- it: should set a custom service account name
  set:
    serviceAccount.create: true
    serviceAccount.name: my-casdoor-sa
  asserts:
  - matchSnapshot: {}

- it: should add annotations
  set:
    serviceAccount.create: true
    serviceAccount.annotations:
      iam.gke.io/gcp-service-account: casdoor@my-project.iam.gserviceaccount.com
  asserts:
  - matchSnapshot: {}
